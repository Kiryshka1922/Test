
name: Frontend Basic Checks

on:
  pull_request:
    branches: [ main, develop ]

jobs:
  check-frontend-pr:
    # –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ PR –∏–∑ –≤–µ—Ç–∫–∏, –Ω–∞—á–∏–Ω–∞—é—â–µ–π—Å—è —Å frontend/
    if: startsWith(github.event.pull_request.head.ref, 'frontend/')
    
    runs-on: ubuntu-latest
    name: Frontend PR Validation
    
    steps:
      - name: Print PR info
        run: |
          echo "‚úÖ –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ PR"
          echo "–í–µ—Ç–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞: ${{ github.event.pull_request.head.ref }}"
          echo "–í–µ—Ç–∫–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è: ${{ github.event.pull_request.base.ref }}"
      
      - name: Hello World
        run: echo "Hello from frontend PR check!"

      - name: Checkout code
        uses: actions/checkout@v3
        with:
          fetch-depth: 0
      
      - name: Check variables.json sync
        run: |
          echo "üîç Check sync variables.json..."
          
          # 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–∞–π–ª –≤ —Ç–µ–∫—É—â–µ–π –≤–µ—Ç–∫–µ (PR)
          # –ï—Å–ª–∏ –≤ –Ω–∞—à–µ–π –≤–µ—Ç–∫–µ –Ω–µ—Ç –∏ 
          if [ ! -f "variables.json" ] && [ ! git show origin/main:variables.json >/dev/null 2>&1 ]; then
            echo "‚ö†Ô∏è File variables.json does not exist in current-branch"
            exit 0
          fi
          
          # 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–∞–π–ª –≤ main
          if ! git show origin/main:variables.json >/dev/null 2>&1; && [ -f "variables.json" ] then
            echo "‚ö†Ô∏è File variables.json does not exist in main"
            exit 0
          fi

          # 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–∞–π–ª –≤ main
          if git show origin/main:variables.json >/dev/null 2>&1; && [ ! -f "variables.json" ] then
            echo "‚ö†Ô∏è File variables.json does not exist in your branch but exist in main"
            exit 1
          fi
          
          echo "–°—Ä–∞–≤–Ω–∏–≤–∞—é variables.json —Å –≤–µ—Ä—Å–∏–µ–π –∏–∑ main..."
          
          if git diff --quiet origin/main HEAD variables.json; then
            echo "‚úÖ variables.json —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω —Å main"
            exit 0
          else
            echo "‚ùå –û–®–ò–ë–ö–ê: variables.json –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –≤–µ—Ä—Å–∏–∏ –≤ main!"
            echo "–ù—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Ä–µ–±–µ–π–∑:"
            echo "  git fetch origin main"
            echo "  git rebase origin/main"
            echo "  # –†–∞–∑—Ä–µ—à–∏—Ç–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –µ—Å–ª–∏ –Ω—É–∂–Ω–æ"
            echo "  git push --force-with-lease"
            exit 1
          fi
